# react-day-02

## Try React

### 在线

React 可以渐进式使用了，既可以为简单的 HTML 页面增加交互，也可以用来搭建一个由 React 驱动的复杂应用。

React 文档中包含很多在线编辑&运行的 sandbox，交互式学习非常有意思

除了 React 文档以外，也还有很多支持 React 的在线代码编辑器，如：CodeSandbox、StackBlitz、CodePen 等

[React 在线演练场](https://zh-hans.react.dev/learn/installation#try-react)

### 本地

> 源码链接：https://gist.githubusercontent.com/gaearon/0275b1e1518599bbeafcde4722e79ed1/raw/db72dcbf3384ee1708c4a07d3be79860db04bff0/example.html

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Hello World</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Don't use this in production: -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
    
      function MyApp() {
        return <h1>Hello, world!</h1>;
      }

      const container = document.getElementById('root');
      const root = ReactDOM.createRoot(container);
      root.render(<MyApp />);

    </script>
    <!--
      Note: this page is a great way to try React but it's not suitable for production.
      It slowly compiles JSX with Babel in the browser and uses a large development build of React.

      Read this page for starting a new React project with JSX:
      https://react.dev/learn/start-a-new-react-project

      Read this page for adding React with JSX to an existing project:
      https://react.dev/learn/add-react-to-an-existing-project
    -->
  </body>
</html>
```
> 注意：“but it's not suitable for production.”

### 其它

“启动一个新的 React 项目”、“添加 React 到一个已有项目”见下面说明

## 启动一个新的 React 项目

https://ggzh-hans.react.dev/learn/start-a-new-react-project

React 官方建议：如果要创建一个 React 新项目，建议直接使用框架

生产级 React 框架推荐如下：
- Next.js
- Remix
- Gatsby
- Expo(原生应用)
- Bleeding-edge React Frameworks
- Next.js(App Router)

### 全栈架构愿景

https://zh-hans.react.dev/learn/start-a-new-react-project#which-features-make-up-the-react-teams-full-stack-architecture-vision

> Next.js 的 App Router 是对 Next.js API 的重新设计，旨在实现 React 团队的全栈架构愿景。它让你在异步组件中获取数据，这些组件甚至能在服务端构建过程中运行。
> 
> Next.js 由 Vercel 维护。你可以将 Next.js 应用 部署到 Node.js 或 serverless 主机上，或部署到你自己的服务器上。Next.js 还支持 静态导出，不需要服务器。

## 添加 React 到一个已有项目

https://zh-hans.react.dev/learn/add-react-to-an-existing-project

> 如果想对现有项目添加一些交互，不必使用 React 将其整个重写。只需将 React 添加到已有技术栈中，就可以在任何位置渲染交互式的 React 组件。

### 在现有网站的子路由中使用 React

场景：`example.com` 是用其它技术构建的 Web 应用，但你又想在 `example.com/some-app/` 部署一个 React 项目

推荐的做法：
1. 使用一个 基于 React 的框架 构建 应用的 React 部分
2. 在框架配置中将 `/some-app` 指定为基本路径
3. 配置服务器或代理，以便所有位于 `/some-app/` 下的请求都由 React 应用处理

### 在现有页面的一部分中使用 React

场景：想要在该页面的某个位置渲染交互式的 React 组件

分两步进行：
1. 配置 JavaScript 环境，以便使用 JSX 语法、import 和 export 语法将代码拆分为模块，以及从 npm 包注册表中使用包（例如 React）
2. 在需要的位置渲染 React 组件

#### 步骤 1：配置模块化的 JS 环境

> 模块化的 JavaScript 环境可以让你在单一的文件中编写 React 组件，而不是在一个文件中编写所有的代码。它还可以让你使用其他开发人员在 npm 注册表上发布的一些特别好用的包，包括 React！

- **如果你的应用已经使用 import 语句来分割成不同的文件，请尝试利用已有的配置**：检查 `<div />` 是否会导致语法错误，如果有报错，可能需要 Babel 来转换你的 JS 代码，并启用 [Babel React preset](https://babeljs.io/docs/babel-preset-react) 来使用 JSX
- **如果你的应用没有用于编译 JavaScript 模块的配置，请使用 Vite 进行配置**：Vite 社区维护了与后端框架（包括 Rails、Django 和 Laravel）的 [许多集成项目](https://github.com/vitejs/awesome-vite#integrations-with-backends)。

简单来说，就是给 React 配置环境～

检查配置是否生效：

执行命令：

```sh
npm install react react-dom
```

然后在你的 JavaScript 主文件（它可能被称为 index.js 或 main.js）的顶部添加以下代码：

```jsx
import { createRoot } from 'react-dom/client';

// 清除现有的 HTML 内容
document.body.innerHTML = '<div id="app"></div>';

// 渲染你的 React 组件
const root = createRoot(document.getElementById('app'));
root.render(<h1>Hello, world</h1>);
```

如果页面的全部内容都被替换为“Hello, world!”，则一切正常！

#### 步骤 2：在页面的任何位置渲染 React 组件

在上一步中，我们按检查步骤清空了整个页面，实际上你并不想，只是想在 HTML 特定位置渲染 React 组件，那么可以向任意标签加个 id，然后可以使用 `document.getElementById` 查找到该 HTML 元素，并将其传递给 `createRoot`，以便可以在其中渲染自己的 React 组件：

index.html：

```html
<!-- ... 你的 HTML 代码某处 ... -->
<nav id="navigation"></nav>
<!-- ... 其他 HTML 代码 ... -->
```

index.js：

```jsx
import { createRoot } from 'react-dom/client';

function NavigationBar() {
  // TODO: 实际实现一个导航栏
  return <h1>Hello from React!</h1>;
}

const domNode = document.getElementById('navigation');
const root = createRoot(domNode);
root.render(<NavigationBar />);
```

> 当在现有项目中采用 React 时，通常会从小型交互式组件（例如按钮）开始，然后逐渐“向上移动”，直到最终整个页面都由 React 构建。

### 在现有的原生移动应用中使用 React Native

React Native 也可以逐步集成到现有的原生应用中。如果已经有一个现有的 Android（Java 或 Kotlin）或 iOS（Objective-C 或 Swift）原生应用，可以参考该 [指南](https://reactnative.dev/docs/integration-with-existing-apps) 将 React Native 添加到其中。

## 编辑器配置

React 社区较为流行的文本编辑器：
- VSCode
- WebStorm
- Sublime Text
- Vim

推荐的文本编辑器功能：
- 代码检查（Linting）
  - VSCode 安装 [ESLint 扩展](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)
  - 安装 React 推荐 ESLint 配置：[eslint-config-react-app](https://www.npmjs.com/package/eslint-config-react-app)
- 格式化
  - 使用 [Prettier](https://prettier.io/) 格式化代码
- 保存并自动格式化

> 提示：请确保你已经为你的项目启用了 `eslint-plugin-react-hooks` 规则。这在 React 项目中是必备的，同时能帮助你及早的捕获较为严重的 bug。

## 使用 TypeScript

安装最新版本的 React 类型定义：

```sh
npm install @types/react @types/react-dom
```

> 注意：每个包含 JSX 的文件都必须使用 `.tsx` 文件扩展名

示例：

```tsx
function MyButton({ title }: { title: string }) {
  return (
    <button>{title}</button>
  );
}

export default function MyApp() {
  return (
    <div>
      <h1>欢迎来到我的应用</h1>
      <MyButton title="我是一个按钮" />
    </div>
  );
}
```

可以用 `interface` 或 `type` 来描述组件的 props：

App.tsx：

```tsx
interface MyButtonProps {
  /** 按钮文字 */
  title: string;
  /** 按钮是否禁用 */
  disabled: boolean;
}

function MyButton({ title, disabled }: MyButtonProps) {
  return (
    <button disabled={disabled}>{title}</button>
  );
}

export default function MyApp() {
  return (
    <div>
      <h1>Welcome to my app</h1>
      <MyButton title="我是一个禁用按钮" disabled={true}/>
    </div>
  );
}
```

## React 开发者工具

https://zh-hans.react.dev/learn/react-developer-tools

安装 Chrome 扩展：[React Developer Tools](https://chromewebstore.google.com/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=en&pli=1)

## 参考

- https://zh-hans.react.dev/learn/installation
- [TypeScript 官方文档](https://www.typescriptlang.org/docs/handbook/) 涵盖了大多数关键的语言特性。
- [TypeScript 发布笔记](https://devblogs.microsoft.com/typescript/) 深入介绍了每一个新特性。
- [React TypeScript Cheatsheet](https://react-typescript-cheatsheet.netlify.app/) 是一个社区维护的，用于在 React 中使用 TypeScript 的速查表，涵盖了许多有用的边界情况，并提供了比本文更广泛全面的内容。